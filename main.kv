#
#  Main app kv language for layour see Python for actions code
#

<Container>:
    display: display
    orientation: "horizontal"

    BoxLayout:
        orientation: "vertical"    
        LabelDraw:
            size_hint: 1.0,1.0
            id: display
        BoxLayout:
            orientation: "vertical"
            size_hint: 1.0,1.0
            BoxLayout:
                orientation: "horizontal"
                ClrButton:
                    size_hint: 1.0,1.0
                    on_release: display.clear_canvas()
                ClrAllButton:
                    size_hint: 1.0,1.0
                    on_release: imageInput.reload()
                    on_release: imageSaliency.reload() 
                    on_release: outcomeGlyph.reload()
                    on_release: imagePlt.reload()
                    on_release: classify.clear_classify()
                    on_release: display.clear_canvas()
            
            SaveButton:
                size_hint: 1.0,1.0
                on_release: display.save_canvas()

            ClassifyButton: 
                id: classify
                size_hint: 1.0,1.0
                #on_realease are Run in reverse order to declaration (obvs...)
                on_release: outcomeGlyph.reload()
                on_release: self.generateGlyph()
                on_release: imagePlt.reload()
                on_release: self.classify_image()

            SaliencyButton:
                id: saliency
                size_hint: 1.0,1.0
                on_release: imageInput.reload()
                on_release: imageSaliency.reload()    
                on_release: self.saliency_image()

            BoxLayout:
                orientation: "horizontal"
                size_hint: 1.0,1.0
                Model00Button: 
                    size_hint: 1.0,1.0
                    id: model00
                    on_release: classify.setModel( 0 )
                    on_release: saliency.setModel( 0 )

                Model01Button: 
                    size_hint: 1.0,1.0
                    id: model01
                    on_release: classify.setModel( 1 )
                    on_release: saliency.setModel( 1 )                    

    BoxLayout:
        orientation: "vertical"
        canvas.before:
            Color:
                rgba: 1,1,1,1
            Rectangle:
                size: self.size
                pos: self.pos
        Image:
            id: outcomeGlyph
            size_hint: 1.0,0.5
            nocache: True 
            allow_stretch: True
            source: 'currentGlyph.png'

        Image:
            id: imagePlt
            nocache: True 
            size_hint: 1.0,0.5
            source: 'classified.png'
            size: self.texture_size
            bcolor: 0.2,0.7,0.2,1.0
            canvas.before:
                Color:
                    rgba: self.bcolor
                Rectangle:
                    pos: self.pos
                    size: self.size           

    BoxLayout:
        orientation: "vertical"

        Image:
            id: imageInput
            nocache: True 
            size_hint: 1.0,0.5
            source: 'cnnInput.png'
            size: self.texture_size
            bcolor: 0.2,0.7,0.2,1.0
            canvas.before:
                Color:
                    rgba: self.bcolor
                Rectangle:
                    pos: self.pos
                    size: self.size     

        Image:
            id: imageSaliency
            nocache: True 
            size_hint: 1.0,0.5
            source: 'saliency.png'
            size: self.texture_size
            bcolor: 0.2,0.7,0.2,1.0
            canvas.before:
                Color:
                    rgba: self.bcolor
                Rectangle:
                    pos: self.pos
                    size: self.size


